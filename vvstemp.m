clc;
V=[3.34615000000000,3.36920939837228,3.38249721994100,3.39087620485883,3.39931116762335,3.40777974576571,3.41624832390807,3.42511494019695,3.43408165132871,3.44329875828096,3.45418715644641,3.46507555461186,3.47418638280752,3.48278262111510,3.49137885942267,3.49932598173932,3.50710345618346,3.51488093062760,3.52221289124313,3.52909233337803,3.53597177551294,3.54211437622501,3.54755831977656,3.55300226332811,3.55844620687966,3.56322734172873,3.56713593966418,3.57104453759963,3.57495313553508,3.57886173347053,3.58277033140598,3.58624697574520,3.58875902147815,3.59127106721111,3.59378311294406,3.59629515867701,3.59880720440996,3.60152825108378,3.60515914553658,3.60879003998938,3.61242093444218,3.61605182889498,3.61968272334778,3.62291626912627,3.62580487201487,3.62869347490348,3.63158207779208,3.63447068068068,3.63735928356928,3.64024788645789,3.64313648934649,3.64646973845597,3.64988579830883,3.65330185816170,3.65671791801456,3.66013397786743,3.66355003772030,3.66696609757316,3.67038215742603,3.67397710258942,3.67760696106847,3.68123681954752,3.68486667802656,3.68849653650561,3.69212639498466,3.69575625346371,3.69938611194275,3.70301597042180,3.70683532350532,3.71091895258895,3.71500258167258,3.71908621075621,3.72316983983984,3.72725346892347,3.73133709800710,3.73542072709073,3.73950435617436,3.74400591327612,3.74875673268244,3.75350755208876,3.75825837149508,3.76300919090140,3.76776001030773,3.77251082971405,3.77726164912037,3.78201246852669,3.78709174369718,3.79217363433037,3.79725552496355,3.80233741559673,3.80741930622992,3.81250119686310,3.81758308749628,3.82321122304354,3.82888186654811,3.83455251005269,3.84022315355726,3.84589379706183,3.85156444056640,3.85723508407097,3.86286678986742,3.86843822902007,3.87400966817273,3.87958110732538,3.88515254647804,3.89072398563069,3.89629542478335,3.90144306520110,3.90635438171371,3.91126569822633,3.91617701473895,3.92108833125156,3.92599964776418,3.93091096427679,3.93582228078941,3.94075685581934,3.94570474232774,3.95065262883613,3.95560051534453,3.96054840185292,3.96549628836132,3.97044417486972,3.97584630814815,3.98141816000000,3.98699001185185,3.99256186370370,3.99813371555556,4.00370556740741,4.00927741925926,4.01556640067058,4.02187151383068,4.02817662699078,4.03448174015088,4.04078685331098,4.04709346072187,4.05351351625020,4.05993357177854,4.06635362730688,4.07277368283521,4.07919373836355,4.08561379389188,4.09332061935941,4.10118648380818,4.10905234825695,4.11691821270572,4.12478407715449,4.13261048935840,4.14031128165294,4.14801207394749,4.15571286624204,4.16341365853659,4.17111445083113,4.17881524312568]
soc=[0,0.00618247134802051,0.0123649426960410,0.0185474140440615,0.0247298853920821,0.0309123567401026,0.0370948280881231,0.0429470255445910,0.0486151076647195,0.0542831897848480,0.0599512719049766,0.0656193540251051,0.0712874361452336,0.0769555182653622,0.0827064901884804,0.0886167985008642,0.0945271068132480,0.100437415125632,0.106347723438016,0.112258031750399,0.118168340062783,0.124078648375167,0.129988956687551,0.135899264999934,0.141809573312318,0.147719881624702,0.153630189937086,0.159598629723915,0.165657649917716,0.171716670111516,0.177775690305316,0.183834710499117,0.189893730692917,0.195952750886717,0.202011771080518,0.208070791274318,0.214129811468118,0.220188831661918,0.226247851855719,0.232306872049519,0.238365892243319,0.244246613305217,0.250062420933334,0.255878228561451,0.261694036189568,0.267509843817685,0.273325651445802,0.279141459073919,0.284957266702036,0.290773074330153,0.296588881958270,0.302404689586387,0.308220497214504,0.314036304842621,0.319852112470738,0.325667920098855,0.331483727726972,0.337299289546778,0.343097663961329,0.348896038375879,0.354694412790430,0.360492787204981,0.366291161619532,0.372089536034083,0.377887910448634,0.383686284863185,0.389484659277736,0.395283033692286,0.401081408106837,0.406945099969295,0.413015403808934,0.419085707648574,0.425156011488214,0.431226315327853,0.437296619167493,0.443366923007133,0.449437226846773,0.455507530686412,0.461577834526052,0.467648138365692,0.473718442205332,0.479788746044971,0.485877202582076,0.492010340265484,0.498143477948893,0.504276615632301,0.510409753315710,0.516542890999118,0.522676028682527,0.528809166365935,0.534942304049344,0.541075441732752,0.547208579416161,0.553341717099569,0.559474854782978,0.565245538389612,0.570930371710900,0.576615205032187,0.582300038353475,0.587984871674763,0.593669704996051,0.599354538317339,0.605039371638626,0.610724204959914,0.616409038281202,0.622093871602490,0.627778704923778,0.633689549744237,0.639657251024439,0.645624952304640,0.651592653584841,0.657560354865042,0.663528056145244,0.669495757425445,0.675463458705646,0.681431159985848,0.687398861266049,0.693366562546250,0.699334263826452,0.705191899643870,0.710814568125380,0.716437236606890,0.722059905088400,0.727682573569910,0.733305242051420,0.738927910532930,0.744550579014440,0.750173247495950,0.755795915977460,0.761418584458970,0.767041252940480,0.773516946284752,0.780704798000687,0.787892649716622,0.795080501432557,0.802268353148492,0.808729671229671,0.813921551421551,0.819113431613432,0.824305311805312,0.829497191997192,0.834784399959559,0.840494365860608,0.846204331761657,0.851914297662705,0.857624263563754,0.863404304950049,0.869262109427567,0.875119913905085,0.880977718382603,0.886835522860120,0.892693327337638,0.898892106983375]
E0 =(0.0026.*temp)+(7.9387.*0.0001.*temp.*soc)+(0.0016.*temp.*soc.*soc)+2.5625;
R=V-E0;
plot (V,soc)
plot (soc,E0);
MAX=0;
for i=1:153
    if soc(i)>0.6
        if soc(i)<0.8
            if R(i)>MAX
                MAX=R(i);
                N=i;
            end
        end
    end
end
    x=soc(N)
    fprintf("soc at RMAX %f",x)


        
